<!DOCTYPE html>
<html lang="es">
<head>
┬а <meta charset="UTF-8">
┬а <meta name="viewport" content="width=device-width, initial-scale=1.0">
┬а <title>Panel de RH - Evaluaci├│n de Sesiones</title>
┬а 
┬а <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
┬а 
┬а <style>
┬а ┬а /* Colores base: Alfasigma azul oscuro, azul cielo, rojo para alertas, blanco/gris claro */
┬а ┬а :root {
┬а ┬а ┬а --primary-dark: #0c0e2c; /* Alfasigma dark blue */
┬а ┬а ┬а --primary-light: #00bfff; /* Sky blue */
┬а ┬а ┬а --secondary-red: #cc0000; /* Alert red */
┬а ┬а ┬а --text-dark: #333;
┬а ┬а ┬а --text-light: #f4f6fa;
┬а ┬а ┬а --bg-light: #f4f6fa;
┬а ┬а ┬а --bg-white: #ffffff;
┬а ┬а ┬а --border-color: #e0e0e0;
┬а ┬а ┬а --shadow-light: rgba(0,0,0,0.05);
┬а ┬а }

┬а ┬а body {
┬а ┬а ┬а margin: 0;
┬а ┬а ┬а font-family: 'Open Sans', sans-serif;
┬а ┬а ┬а background-color: var(--bg-light);
┬а ┬а ┬а color: var(--text-dark);
┬а ┬а ┬а line-height: 1.6;
┬а ┬а }

┬а ┬а header {
┬а ┬а ┬а background: var(--primary-dark);
┬а ┬а ┬а color: var(--text-light);
┬а ┬а ┬а padding: 20px 40px;
┬а ┬а ┬а display: flex;
┬а ┬а ┬а align-items: center;
┬а ┬а ┬а justify-content: space-between; /* To place logo and title */
┬а ┬а ┬а box-shadow: 0 2px 8px var(--shadow-light);
┬а ┬а }

┬а ┬а header img {
┬а ┬а ┬а ┬а height: 45px; /* Slightly larger logo */
┬а ┬а ┬а ┬а vertical-align: middle;
┬а ┬а ┬а ┬а margin-right: 15px; /* Space between logo and title */
┬а ┬а }

┬а ┬а header h1 {
┬а ┬а ┬а margin: 0;
┬а ┬а ┬а font-size: 26px; /* Slightly larger title */
┬а ┬а ┬а font-family: 'Montserrat', sans-serif;
┬а ┬а ┬а font-weight: 700;
┬а ┬а ┬а flex-grow: 1; /* Allows title to take available space */
┬а ┬а }

┬а ┬а .container {
┬а ┬а ┬а padding: 30px 40px;
┬а ┬а ┬а max-width: 1200px; /* Limit content width for better readability */
┬а ┬а ┬а margin: 0 auto; /* Center the container */
┬а ┬а }

┬а ┬а .section-title {
┬а ┬а ┬а font-family: 'Montserrat', sans-serif;
┬а ┬а ┬а font-weight: 700;
┬а ┬а ┬а font-size: 24px;
┬а ┬а ┬а color: var(--primary-dark);
┬а ┬а ┬а margin-top: 40px;
┬а ┬а ┬а margin-bottom: 20px;
┬а ┬а ┬а border-bottom: 2px solid var(--primary-light);
┬а ┬а ┬а padding-bottom: 10px;
┬а ┬а }

┬а ┬а .session-entry {
┬а ┬а ┬а background: var(--bg-white);
┬а ┬а ┬а padding: 25px; /* Increased padding */
┬а ┬а ┬а margin-bottom: 25px; /* Increased margin */
┬а ┬а ┬а border-radius: 12px; /* More rounded corners */
┬а ┬а ┬а box-shadow: 0 6px 20px var(--shadow-light); /* More prominent shadow */
┬а ┬а ┬а border: 1px solid var(--border-color);
┬а ┬а }

┬а ┬а .session-entry h3 {
┬а ┬а ┬а margin-top: 0;
┬а ┬а ┬а font-family: 'Montserrat', sans-serif;
┬а ┬а ┬а font-weight: 600;
┬а ┬а ┬а font-size: 20px;
┬а ┬а ┬а color: var(--primary-dark);
┬а ┬а ┬а border-bottom: 1px solid #eee;
┬а ┬а ┬а padding-bottom: 10px;
┬а ┬а ┬а margin-bottom: 15px;
┬а ┬а }

┬а ┬а .session-info strong {
┬а ┬а ┬а ┬а color: #555; /* Slightly darker for labels */
┬а ┬а }

┬а ┬а .chat-log {
┬а ┬а ┬а background: #eef7fc; /* Lighter blue background */
┬а ┬а ┬а border-left: 5px solid var(--primary-light); /* Thicker, more prominent border */
┬а ┬а ┬а padding: 15px; /* More padding */
┬а ┬а ┬а margin-top: 20px; /* More margin */
┬а ┬а ┬а font-size: 15px;
┬а ┬а ┬а border-radius: 8px; /* Rounded corners */
┬а ┬а }
┬а ┬а .chat-log p {
┬а ┬а ┬а ┬а margin: 5px 0; /* Adjust spacing within chat log */
┬а ┬а }
┬а ┬а .chat-log ul {
┬а ┬а ┬а ┬а list-style-type: disc; /* Bullet points */
┬а ┬а ┬а ┬а padding-left: 20px; /* Indent list */
┬а ┬а ┬а ┬а margin-top: 5px;
┬а ┬а ┬а ┬а margin-bottom: 5px;
┬а ┬а }
┬а ┬а .chat-log li {
┬а ┬а ┬а ┬а margin-bottom: 5px; /* Space between list items */
┬а ┬а }


┬а ┬а .evaluation {
┬а ┬а ┬а background: #e0f7fa; /* Light cyan */
┬а ┬а ┬а padding: 15px;
┬а ┬а ┬а margin-top: 20px;
┬а ┬а ┬а border-left: 5px solid #0099cc; /* Darker blue border */
┬а ┬а ┬а border-radius: 8px;
┬а ┬а }

┬а ┬а .evaluation strong {
┬а ┬а ┬а ┬а color: #007bb5; /* Stronger blue for evaluation labels */
┬а ┬а }

┬а ┬а .evaluation.rh {
┬а ┬а ┬а background: #ffeeee; /* Very light red */
┬а ┬а ┬а border-left: 5px solid var(--secondary-red); /* Strong red border */
┬а ┬а }
┬а ┬а .evaluation.rh strong {
┬а ┬а ┬а ┬а color: var(--secondary-red); /* Strong red for RH labels */
┬а ┬а }

┬а ┬а video {
┬а ┬а ┬а width: 100%;
┬а ┬а ┬а max-width: 500px; /* Slightly larger video preview */
┬а ┬а ┬а margin-top: 20px; /* More margin */
┬а ┬а ┬а border-radius: 8px;
┬а ┬а ┬а box-shadow: 0 4px 10px rgba(0,0,0,0.1); /* Subtle shadow on video */
┬а ┬а ┬а display: block; /* Ensures it takes full width up to max-width */
┬а ┬а }

┬а ┬а .users-section, .summary-row {
┬а ┬а ┬а background: var(--bg-white);
┬а ┬а ┬а margin-top: 40px;
┬а ┬а ┬а padding: 25px;
┬а ┬а ┬а border-radius: 12px;
┬а ┬а ┬а box-shadow: 0 6px 20px var(--shadow-light);
┬а ┬а ┬а border: 1px solid var(--border-color);
┬а ┬а }

┬а ┬а table {
┬а ┬а ┬а width: 100%;
┬а ┬а ┬а border-collapse: collapse;
┬а ┬а ┬а margin-top: 20px;
┬а ┬а }

┬а ┬а th, td {
┬а ┬а ┬а border: 1px solid var(--border-color);
┬а ┬а ┬а padding: 12px 8px; /* More padding in table cells */
┬а ┬а ┬а text-align: left; /* Align text left for better readability */
┬а ┬а ┬а font-size: 14px;
┬а ┬а }

┬а ┬а th {
┬а ┬а ┬а background-color: #f8f8f8; /* Lighter grey for headers */
┬а ┬а ┬а font-family: 'Montserrat', sans-serif;
┬а ┬а ┬а font-weight: 600;
┬а ┬а ┬а color: var(--primary-dark);
┬а ┬а ┬а text-transform: uppercase; /* Uppercase table headers */
┬а ┬а }
┬а ┬а 
┬а ┬а tr:nth-child(even) { /* Zebra striping for tables */
┬а ┬а ┬а ┬а background-color: #fdfdfd;
┬а ┬а }
┬а ┬а tr:hover { /* Hover effect for table rows */
┬а ┬а ┬а ┬а background-color: #f0f8ff;
┬а ┬а }

┬а ┬а h2, h3 {
┬а ┬а ┬а font-family: 'Montserrat', sans-serif;
┬а ┬а ┬а font-weight: 700;
┬а ┬а ┬а color: var(--primary-dark);
┬а ┬а ┬а margin-top: 0; /* Reset margin from previous style */
┬а ┬а }

┬а ┬а /* Form styling */
┬а ┬а form {
┬а ┬а ┬а ┬а display: flex;
┬а ┬а ┬а ┬а flex-wrap: wrap;
┬а ┬а ┬а ┬а gap: 10px; /* Spacing between form elements */
┬а ┬а ┬а ┬а margin-top: 15px;
┬а ┬а ┬а ┬а align-items: center;
┬а ┬а }
┬а ┬а form.user-management-actions { /* Styles for inline forms in user actions */
┬а ┬а ┬а ┬а display: inline-flex;
┬а ┬а ┬а ┬а margin: 0;
┬а ┬а ┬а ┬а gap: 5px;
┬а ┬а }

┬а ┬а form input[type="text"], 
┬а ┬а form input[type="email"], 
┬а ┬а form input[type="date"],
┬а ┬а form input[type="password"] { /* Added password type for login if needed */
┬а ┬а ┬а flex: 1; /* Allow inputs to grow */
┬а ┬а ┬а min-width: 150px; /* Minimum width for inputs */
┬а ┬а ┬а padding: 10px 12px;
┬а ┬а ┬а border-radius: 6px;
┬а ┬а ┬а border: 1px solid #ccc;
┬а ┬а ┬а box-shadow: inset 0 1px 3px rgba(0,0,0,0.05);
┬а ┬а ┬а transition: border-color 0.2s ease;
┬а ┬а }
┬а ┬а form input:focus {
┬а ┬а ┬а ┬а border-color: var(--primary-light);
┬а ┬а ┬а ┬а outline: none;
┬а ┬а }

┬а ┬а form button {
┬а ┬а ┬а padding: 10px 18px; /* Larger buttons */
┬а ┬а ┬а border: none;
┬а ┬а ┬а border-radius: 6px;
┬а ┬а ┬а background-color: var(--primary-light);
┬а ┬а ┬а color: white;
┬а ┬а ┬а cursor: pointer;
┬а ┬а ┬а font-size: 15px;
┬а ┬а ┬а font-weight: 600;
┬а ┬а ┬а transition: background-color 0.2s ease, transform 0.1s ease;
┬а ┬а ┬а white-space: nowrap; /* Prevent button text from wrapping */
┬а ┬а }

┬а ┬а form button:hover {
┬а ┬а ┬а background-color: #009acd;
┬а ┬а ┬а transform: translateY(-1px); /* Slight lift effect */
┬а ┬а }
┬а ┬а form button:active {
┬а ┬а ┬а ┬а transform: translateY(0); /* Press down effect */
┬а ┬а }

┬а ┬а /* Specific button overrides for user actions */
┬а ┬а form.user-management-actions button {
┬а ┬а ┬а ┬а padding: 8px 12px;
┬а ┬а ┬а ┬а font-size: 13px;
┬а ┬а }
┬а ┬а form.user-management-actions button[name="action"][value="toggle"] {
┬а ┬а ┬а ┬а background-color: #ffc107; /* Orange for toggle */
┬а ┬а ┬а ┬а color: var(--text-dark);
┬а ┬а }
┬а ┬а form.user-management-actions button[name="action"][value="toggle"]:hover {
┬а ┬а ┬а ┬а background-color: #e0a800;
┬а ┬а }
┬а ┬а form.user-management-actions button[name="action"][value="regen_token"] {
┬а ┬а ┬а ┬а background-color: #6c757d; /* Grey for new token */
┬а ┬а }
┬а ┬а form.user-management-actions button[name="action"][value="regen_token"]:hover {
┬а ┬а ┬а ┬а background-color: #5a6268;
┬а ┬а }

┬а ┬а .summary-row h3 {
┬а ┬а ┬а font-size: 20px;
┬а ┬а }

┬а ┬а .progress-bar {
┬а ┬а ┬а background: #e9ecef; /* Lighter background for bar */
┬а ┬а ┬а border-radius: 8px;
┬а ┬а ┬а overflow: hidden;
┬а ┬а ┬а height: 25px; /* Taller bar */
┬а ┬а ┬а margin-top: 15px;
┬а ┬а ┬а border: 1px solid #dee2e6;
┬а ┬а }

┬а ┬а .progress-fill {
┬а ┬а ┬а height: 100%;
┬а ┬а ┬а background: linear-gradient(to right, #00bfff, #007bff); /* Gradient for progress */
┬а ┬а ┬а transition: width 0.4s ease-out; /* Smoother transition */
┬а ┬а ┬а display: flex;
┬а ┬а ┬а align-items: center;
┬а ┬а ┬а justify-content: flex-end;
┬а ┬а ┬а padding-right: 10px;
┬а ┬а ┬а box-sizing: border-box;
┬а ┬а ┬а color: white;
┬а ┬а ┬а font-weight: bold;
┬а ┬а ┬а font-size: 0.9em;
┬а ┬а ┬а text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
┬а ┬а }
┬а ┬а .progress-fill span {
┬а ┬а ┬а ┬а white-space: nowrap;
┬а ┬а }

┬а ┬а /* Styles for the new structured RH analysis (from previous iteration) */
┬а ┬а .evaluation.rh h4 {
┬а ┬а ┬а ┬а color: var(--secondary-red); /* Darker red for sub-headings */
┬а ┬а ┬а ┬а margin-top: 15px;
┬а ┬а ┬а ┬а margin-bottom: 5px;
┬а ┬а ┬а ┬а font-family: 'Montserrat', sans-serif;
┬а ┬а ┬а ┬а font-weight: 600;
┬а ┬а }

┬а ┬а .evaluation.rh ul {
┬а ┬а ┬а ┬а list-style-type: none; /* Remove default bullets */
┬а ┬а ┬а ┬а padding-left: 0;
┬а ┬а ┬а ┬а margin-left: 0;
┬а ┬а }

┬а ┬а .evaluation.rh li {
┬а ┬а ┬а ┬а margin-bottom: 8px;
┬а ┬а ┬а ┬а padding-left: 20px; /* Indent list items */
┬а ┬а ┬а ┬а position: relative; /* For custom bullet points */
┬а ┬а }
┬а ┬а .evaluation.rh li::before { /* Custom bullet points */
┬а ┬а ┬а ┬а content: 'Рђб';
┬а ┬а ┬а ┬а color: var(--primary-light); /* Blue bullet */
┬а ┬а ┬а ┬а position: absolute;
┬а ┬а ┬а ┬а left: 0;
┬а ┬а ┬а ┬а top: 0;
┬а ┬а }
┬а ┬а .evaluation.rh li strong {
┬а ┬а ┬а ┬а color: var(--text-dark); /* Ensure strong text is dark */
┬а ┬а }
┬а ┬а .metric-line {
┬а ┬а ┬а ┬а display: flex;
┬а ┬а ┬а ┬а justify-content: space-between;
┬а ┬а ┬а ┬а padding: 5px 0;
┬а ┬а ┬а ┬а border-bottom: 1px dashed #f0c0c0;
┬а ┬а ┬а ┬а font-size: 0.95em;
┬а ┬а }
┬а ┬а .metric-line:last-child {
┬а ┬а ┬а ┬а border-bottom: none;
┬а ┬а }
┬а ┬а .metric-label {
┬а ┬а ┬а ┬а font-weight: 600; /* Bolder label */
┬а ┬а }
┬а ┬а .metric-value {
┬а ┬а ┬а ┬а text-align: right;
┬а ┬а ┬а ┬а font-weight: 400;
┬а ┬а }
┬а ┬а .status-icon {
┬а ┬а ┬а ┬а font-size: 1.1em;
┬а ┬а ┬а ┬а margin-right: 5px;
┬а ┬а }

┬а ┬а /* Footer styling */
┬а ┬а footer {
┬а ┬а ┬а ┬а text-align: center;
┬а ┬а ┬а ┬а padding: 30px;
┬а ┬а ┬а ┬а margin-top: 50px;
┬а ┬а ┬а ┬а font-size: 0.9em;
┬а ┬а ┬а ┬а color: #777;
┬а ┬а ┬а ┬а border-top: 1px solid #eee;
┬а ┬а ┬а ┬а background-color: var(--bg-white);
┬а ┬а }
┬а ┬а footer a {
┬а ┬а ┬а ┬а color: var(--primary-light);
┬а ┬а ┬а ┬а text-decoration: none;
┬а ┬а ┬а ┬а font-weight: 600;
┬а ┬а }
┬а ┬а footer a:hover {
┬а ┬а ┬а ┬а text-decoration: underline;
┬а ┬а }

┬а ┬а /* Adjust specific forms for layout */
┬а ┬а .users-section form {
┬а ┬а ┬а ┬а display: grid;
┬а ┬а ┬а ┬а grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
┬а ┬а ┬а ┬а gap: 15px;
┬а ┬а ┬а ┬а align-items: end;
┬а ┬а }
┬а ┬а .users-section form button {
┬а ┬а ┬а ┬а grid-column: span 1; /* Ensure button fits in grid */
┬а ┬а }
┬а ┬а .users-section form input {
┬а ┬а ┬а ┬а width: auto; /* Let grid control width */
┬а ┬а }
┬а ┬а .users-section form label {
┬а ┬а ┬а ┬а display: block; /* Ensure labels are on their own line */
┬а ┬а ┬а ┬а margin-bottom: 5px;
┬а ┬а ┬а ┬а font-weight: 600;
┬а ┬а ┬а ┬а color: #555;
┬а ┬а }
┬а ┬а .users-section form input[type="date"] {
┬а ┬а ┬а ┬а min-width: 120px;
┬а ┬а }
┬а ┬а .users-section h3 { /* For "Crear nuevo usuario" */
┬а ┬а ┬а ┬а margin-top: 30px;
┬а ┬а ┬а ┬а padding-top: 15px;
┬а ┬а ┬а ┬а border-top: 1px dashed var(--border-color);
┬а ┬а }
┬а </style>
</head>
<body>
┬а <header>
┬а ┬а <img src="{{ url_for('static', filename='logo-alfasigma.png') }}" alt="Alfasigma">
┬а ┬а <h1>­ЪЊі Panel de RH - Evaluaci├│n de Sesiones</h1>
┬а </header>

┬а <div class="container">
┬а ┬а <h2 class="section-title">Resultados de Sesiones Individuales</h2>
┬а ┬а {% for row in data %}
┬а ┬а ┬а <div class="session-entry">
┬а ┬а ┬а ┬а <h3>{{ row[1] }} <span style="font-weight: normal; color: #777;">({{ row[2] }})</span></h3>
┬а ┬а ┬а ┬а <p class="session-info">
┬а ┬а ┬а ┬а ┬а ┬а <strong>Escenario:</strong> {{ row[3] }}<br>
┬а ┬а ┬а ┬а ┬а ┬а <strong>Fecha:</strong> {{ row[7] }}
┬а ┬а ┬а ┬а </p>

┬а ┬а ┬а ┬а <div class="chat-log">
┬а ┬а ┬а ┬а ┬а <p><strong>Participante:</strong></p>
┬а ┬а ┬а ┬а ┬а <ul>
┬а ┬а ┬а ┬а ┬а ┬а {% for segment in row[4] %}
┬а ┬а ┬а ┬а ┬а ┬а ┬а <li>{{ segment }}</li>
┬а ┬а ┬а ┬а ┬а ┬а {% endfor %}
┬а ┬а ┬а ┬а ┬а </ul>
┬а ┬а ┬а ┬а ┬а <p class="mt-3"><strong>Leo:</strong></p>
┬а ┬а ┬а ┬а ┬а <ul>
┬а ┬а ┬а ┬а ┬а ┬а {% for segment in row[5] %}
┬а ┬а ┬а ┬а ┬а ┬а ┬а <li>{{ segment }}</li>
┬а ┬а ┬а ┬а ┬а ┬а {% endfor %}
┬а ┬а ┬а ┬а ┬а </ul>
┬а ┬а ┬а ┬а </div>

┬а ┬а ┬а ┬а {% if row[6] and row[6] != "Video_Not_Available_Error" and row[6] != "Video_Processing_Failed" and row[6] != "Video_Missing_Error" %}
┬а ┬а ┬а ┬а<video controls>
┬а ┬а ┬а ┬а <source src="{{ row[6] }}" type="video/mp4" />
┬а ┬а ┬а Tu navegador no soporta la reproducci├│n de video.
┬а ┬а ┬а </video>
┬а ┬а ┬а ┬а {% else %}
┬а ┬а ┬а ┬а ┬а <p style="color: gray; text-align: center;">РЈ│ Esta sesi├│n se mostrar├А completa cuando el an├Аlisis haya terminado o el video no est├А disponible.</p>
┬а ┬а ┬а ┬а {% endif %}


┬а ┬а ┬а ┬а <div class="evaluation">
┬а ┬а ┬а ┬а ┬а <strong>Resumen para usuario:</strong><br>
┬а ┬а ┬а ┬а ┬а {{ row[8] }}
┬а ┬а ┬а ┬а </div>

┬а ┬а ┬а ┬а <div class="evaluation rh">
┬а ┬а ┬а ┬а ┬а {% if row[9].overall_rh_summary %}
┬а ┬а ┬а ┬а ┬а ┬а <strong>An├Аlisis para RH:</strong><br>
┬а ┬а ┬а ┬а ┬а ┬а <p><strong>Resumen General RH:</strong> {{ row[9].overall_rh_summary }}</p>

┬а ┬а ┬а ┬а ┬а ┬а <h4>­Ъј» Aplicaci├│n del Modelo de Ventas (Da Vinci)</h4>
┬а ┬а ┬а ┬а ┬а ┬а <div style="border: 1px solid var(--border-color); padding: 10px; border-radius: 5px;">
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <div class="metric-line">
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <span class="metric-label">Diagn├│stico:</span>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <span class="metric-value">{{ row[9].gpt_detailed_feedback.Diagnostico if row[9].gpt_detailed_feedback and row[9].gpt_detailed_feedback.Diagnostico is defined else 'N/A' }}</span>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а </div>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <div class="metric-line">
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <span class="metric-label">Argumentaci├│n:</span>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <span class="metric-value">{{ row[9].gpt_detailed_feedback.Argumentacion if row[9].gpt_detailed_feedback and row[9].gpt_detailed_feedback.Argumentacion is defined else 'N/A'}}</span>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а </div>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <div class="metric-line">
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <span class="metric-label">Validaci├│n:</span>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <span class="metric-value">{{ row[9].gpt_detailed_feedback.Validacion if row[9].gpt_detailed_feedback and row[9].gpt_detailed_feedback.Validacion is defined else 'N/A'}}</span>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а </div>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <div class="metric-line">
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <span class="metric-label">Cierre:</span>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <span class="metric-value">{{ row[9].gpt_detailed_feedback.Cierre if row[9].gpt_detailed_feedback and row[9].gpt_detailed_feedback.Cierre is defined else 'N/A'}}</span>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а </div>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <p style="text-align: right; margin-top: 5px; font-size: 0.85em; color: #666;">
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а (Pasos detectados por an├Аlisis simple: {{ row[9].sales_model_simple_detection.steps_applied_count if row[9].sales_model_simple_detection and row[9].sales_model_simple_detection.steps_applied_count is defined else 'N/A' }})
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а </p>
┬а ┬а ┬а ┬а ┬а ┬а </div>

┬а ┬а ┬а ┬а ┬а ┬а <h4>­ЪДа Conocimientos y Habilidades Clave</h4>
┬а ┬а ┬а ┬а ┬а ┬а <div style="border: 1px solid var(--border-color); padding: 10px; border-radius: 5px;">
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <div class="metric-line">
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <span class="metric-label">Palabras clave cient├Гficas:</span>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <span class="metric-value">{{ row[9].knowledge_score if row[9].knowledge_score else 'N/A' }}</span>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а </div>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <div class="metric-line">
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <span class="metric-label">Escucha Activa (Simple):</span>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <span class="metric-value">{{ row[9].active_listening_simple_detection if row[9].active_listening_simple_detection else 'N/A' }}</span>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а </div>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <div class="metric-line">
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <span class="metric-label">Presencia en Video:</span>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <span class="metric-value">{{ row[9].visual_presence if row[9].visual_presence else 'N/A' }} ({{ row[9].visual_percentage if row[9].visual_percentage else 'N/A' }})</span>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а </div>
┬а ┬а ┬а ┬а ┬а ┬а </div>

┬а ┬а ┬а ┬а ┬а ┬а {% if row[9].gpt_detailed_feedback %}
┬а ┬а ┬а ┬а ┬а ┬а ┬а <h4>Comentarios Detallados de la Inteligencia Artificial:</h4>
┬а ┬а ┬а ┬а ┬а ┬а ┬а <div style="background: #fdfdff; padding: 15px; border-radius: 8px; border: 1px solid #e9e9e9;">
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а {% if row[9].gpt_detailed_feedback.overall_evaluation %}
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <p><strong>Evaluaci├│n General de la IA:</strong> {{ row[9].gpt_detailed_feedback.overall_evaluation }}</p>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а {% endif %}

                {# Corrected fields for Da Vinci Model feedback #}
                {% if row[9].gpt_detailed_feedback.Diagnostico is defined %}
                  <p><strong>Diagn├│stico:</strong> {{ row[9].gpt_detailed_feedback.Diagnostico }}</p>
                {% endif %}
                {% if row[9].gpt_detailed_feedback.Argumentacion is defined %}
                  <p><strong>Argumentaci├│n:</strong> {{ row[9].gpt_detailed_feedback.Argumentacion }}</p>
                {% endif %}
                {% if row[9].gpt_detailed_feedback.Validacion is defined %}
                  <p><strong>Validaci├│n:</strong> {{ row[9].gpt_detailed_feedback.Validacion }}</p>
                {% endif %}
                {% if row[9].gpt_detailed_feedback.Cierre is defined %}
                  <p><strong>Cierre:</strong> {{ row[9].gpt_detailed_feedback.Cierre }}</p>
                {% endif %}


                {# Corrected fields for other detailed feedback sections #}
                {% if row[9].gpt_detailed_feedback.Prioridad_en_uso_del_tiempo is defined %}
                  <p><strong>Prioridad en uso del tiempo:</strong> {{ row[9].gpt_detailed_feedback.Prioridad_en_uso_del_tiempo }}</p>
                {% endif %}
                {% if row[9].gpt_detailed_feedback.Adaptacion_al_estilo_del_medico is defined %}
                  <p><strong>Adaptaci├│n al estilo del m├Еdico:</strong>
                    {% if row[9].gpt_detailed_feedback.Adaptacion_al_estilo_del_medico.comentarios is defined %}
                        {{ row[9].gpt_detailed_feedback.Adaptacion_al_estilo_del_medico.comentarios }}
                    {% else %}
                        N/A
                    {% endif %}
                  </p>
                {% endif %}
                {% if row[9].gpt_detailed_feedback.Control_de_la_conversacion is defined %}
                  <p><strong>Control de la conversaci├│n:</strong> {{ row[9].gpt_detailed_feedback.Control_de_la_conversacion }}</p>
                {% endif %}
                {% if row[9].gpt_detailed_feedback.Manejo_de_preguntas_criticas_del_medico is defined %}
                  <p><strong>Manejo de preguntas cr├Гticas del m├Еdico:</strong> {{ row[9].gpt_detailed_feedback.Manejo_de_preguntas_criticas_del_medico }}</p>
                {% endif %}
                {% if row[9].gpt_detailed_feedback.Manejo_de_objeciones is defined %}
                  <p><strong>Manejo de objeciones:</strong> {{ row[9].gpt_detailed_feedback.Manejo_de_objeciones }}</p>
                {% endif %}
                {% if row[9].gpt_detailed_feedback.Escucha_activa is defined %}
                  <p><strong>Escucha activa:</strong> {{ row[9].gpt_detailed_feedback.Escucha_activa }}</p>
                {% endif %}

┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а {% if row[9].gpt_detailed_feedback.Areas_de_mejora %}
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <p><strong>├Ђreas de Mejora Espec├Гficas (Sugerencias de la IA para Coaching):</strong></p>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <ul>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а {% for area in row[9].gpt_detailed_feedback.Areas_de_mejora %}
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <li>{{ area }}</li>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а {% endfor %}
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а </ul>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а {% endif %}

┬а ┬а ┬а ┬а ┬а ┬а ┬а </div>
┬а ┬а ┬а ┬а ┬а ┬а {% else %}
┬а ┬а ┬а ┬а ┬а ┬а ┬а <p>No hay feedback detallado de la IA disponible para esta sesi├│n.</p>
┬а ┬а ┬а ┬а ┬а ┬а {% endif %}

┬а ┬а ┬а ┬а ┬а {% endif %}
┬а ┬а ┬а ┬а ┬а <div style="margin-top: 20px; text-align: right;">
┬а ┬а ┬а ┬а <form action="/admin/delete_session/{{ row[0] }}" method="POST" onsubmit="return confirm('┬┐Est├Аs seguro de que quieres eliminar esta sesi├│n y su video?');">
┬а ┬а ┬а ┬а ┬а <button type="submit" style="background-color: #dc3545; color: white; padding: 8px 15px; border-radius: 5px; border: none; cursor: pointer;">
┬а ┬а ┬а ┬а ┬а ┬а ­ЪЌЉ№ИЈ Eliminar Sesi├│n
┬а ┬а ┬а ┬а ┬а </button>
┬а ┬а ┬а ┬а </form>
┬а ┬а ┬а ┬а </div>
┬а ┬а ┬а </div>
┬а ┬а {% endfor %}


┬а ┬а <h2 class="section-title">­ЪЊѕ Resumen de Tiempo por Usuario</h2>
┬а ┬а <div class="summary-row">
┬а ┬а ┬а <table>
┬а ┬а ┬а ┬а <tr><th>Nombre</th><th>Email</th><th>Minutos usados</th><th>Resumen ejecutivo</th></tr>
┬а ┬а ┬а ┬а {% for summary in usage_summaries %}
┬а ┬а ┬а ┬а <tr>
┬а ┬а ┬а ┬а ┬а <td>{{ summary.name }}</td>
┬а ┬а ┬а ┬а ┬а <td>{{ summary.email }}</td>
┬а ┬а ┬а ┬а ┬а <td>{{ summary.minutes }}</td>
┬а ┬а ┬а ┬а ┬а <td>{{ summary.summary }}</td>
┬а ┬а ┬а ┬а </tr>
┬а ┬а ┬а ┬а {% endfor %}
┬а ┬а ┬а </table>

┬а ┬а ┬а <h3>Tiempo Total Usado: {{ total_minutes }} / 1050 minutos</h3>
┬а ┬а ┬а <div class="progress-bar">
┬а ┬а ┬а ┬а <div class="progress-fill" style="width: {{ (total_minutes / 1050) * 100 }}%">
┬а ┬а ┬а ┬а ┬а ┬а <span>{{ (total_minutes / 1050) * 100 | round(1) }}%</span>
┬а ┬а ┬а ┬а </div>
┬а ┬а ┬а </div>
┬а ┬а </div>

┬а ┬а <h2 class="section-title">­Ъћљ Gesti├│n de Usuarios</h2>
┬а ┬а <div class="users-section">
┬а ┬а ┬а <h3>Crear nuevo usuario (si no existe) / Ingresar a Dashboard (si ya est├А creado)</h3>
┬а ┬а ┬а <form action="/dashboard" method="POST">
┬а ┬а ┬а ┬а <label for="new_user_name">Nombre:</label>
┬а ┬а ┬а ┬а <input type="text" id="new_user_name" name="name" placeholder="Nombre" required>

┬а ┬а ┬а ┬а <label for="new_user_email">Correo electr├│nico:</label>
┬а ┬а ┬а ┬а <input type="email" id="new_user_email" name="email" placeholder="Correo electr├│nico" required>

┬а ┬а ┬а ┬а <label for="new_user_token">Token:</label>
┬а ┬а ┬а ┬а <input type="text" id="new_user_token" name="token" placeholder="Token" required>
┬а ┬а ┬а ┬а 
┬а ┬а ┬а ┬а <button type="submit">Ingresar a Dashboard</button>
┬а ┬а ┬а </form>

┬а ┬а ┬а <table>
┬а ┬а ┬а ┬а <tr>
┬а ┬а ┬а ┬а ┬а <th>Nombre</th><th>Email</th><th>Token</th><th>Rango de Fechas</th><th>Activo</th><th>Acciones</th>
┬а ┬а ┬а ┬а </tr>
┬а ┬а ┬а ┬а {% for user in users %}
┬а ┬а ┬а ┬а <tr>
┬а ┬а ┬а ┬а ┬а <td>{{ user[1] }}</td>
┬а ┬а ┬а ┬а ┬а <td>{{ user[2] }}</td>
┬а ┬а ┬а ┬а ┬а <td>{{ user[6] }}</td>
┬а ┬а ┬а ┬а ┬а <td>{{ user[3] }} - {{ user[4] }}</td>
┬а ┬а ┬а ┬а ┬а <td>{{ "S├Г" if user[5] else "No" }}</td>
┬а ┬а ┬а ┬а ┬а <td>
┬а ┬а ┬а ┬а ┬а ┬а <form class="user-management-actions" action="/admin" method="POST">
┬а ┬а ┬а ┬а ┬а ┬а ┬а <input type="hidden" name="user_id" value="{{ user[0] }}">
┬а ┬а ┬а ┬а ┬а ┬а ┬а <button type="submit" name="action" value="toggle">
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а {{ "Desactivar" if user[5] else "Activar" }}
┬а ┬а ┬а ┬а ┬а ┬а ┬а </button>
┬а ┬а ┬а ┬а ┬а ┬а ┬а <button type="submit" name="action" value="regen_token">
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а Nuevo Token
┬а ┬а ┬а ┬а ┬а ┬а ┬а </button>
┬а ┬а ┬а ┬а ┬а ┬а </form>
┬а ┬а ┬а ┬а ┬а </td>
┬а ┬а ┬а ┬а </tr>
┬а ┬а ┬а ┬а {% endfor %}
┬а ┬а ┬а </table>
┬а ┬а </div>
┬а <footer>
┬а ┬а <p>Desarrollado por <a href="https://www.teams.com.mx" target="_blank">Teams</a> &copy; 2025</p>
┬а </footer>
</body>
</html>